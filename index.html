<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>index</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="main.css" />
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- 이 아래부터 jQuery 사용가능  -->
  </head>
  <!-- =================================HTML============================================= -->

  <body class="" id="body">
    <!-- 모달창 -->
    <div class="black-bg" id="login-modal">
      <div class="white-bg">
        <h4>로그인하세요</h4>
        <form action="success.html" id="login-form">
          <div class="mb-3">
            <label>이메일</label>
            <input type="text" id="email" class="form-control" />
          </div>
          <div class="mb-3">
            <label>패스워드</label>
            <input type="password" id="password" class="form-control" />
          </div>
          <p id="pwLength" style="color: red">비번은 7자 이상</p>
          <button type="submit" class="btn btn-primary" id="login-submit">
            로그인
          </button>
          <button type="button" class="btn btn-danger" id="close">닫기</button>
        </form>
      </div>
    </div>

    <!-- navbar -->
    <nav class="navbar navbar-light bg-light">
      <div class="container-fluid">
        <span class="navbar-brand">HenShop</span>
        <span class="badge bg-dark" id="darkMode">Dark</span>
        <button class="navbar-toggler" type="button">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
    </nav>

    <ul class="list-group">
      <li class="list-group-item">item 1</li>
      <li class="list-group-item">item 2</li>
      <li class="list-group-item">item 3</li>
      <li class="list-group-item">item 4</li>
      <li class="list-group-item">item 5</li>
    </ul>

    <!-- 메인페이지 -->
    <div id="mainComponent" class="margin-bg">
      <h4>Shirts on Sale</h4>
      <button id="login-btn" class="btn btn-danger">로그인</button>
    </div>
    <div class="alert alert-danger">5초 이내 구매시 사은품 증정!</div>

    <!-- 사진 -->
    <div style="overflow: hidden">
      <div class="slide-container">
        <div class="slide-box">
          <img src="1.jpg" draggable="false" />
        </div>
        <div class="slide-box">
          <img src="2.jpg" draggable="false" />
        </div>
        <div class="slide-box">
          <img src="3.jpg" draggable="false" />
        </div>
      </div>
    </div>

    <button class="prePic">이전</button>
    <button class="slide-1">1</button>
    <button class="slide-2">2</button>
    <button class="slide-3">3</button>
    <button class="nextPic">다음</button>

    <!-- 회원약관 -->
    <div
      class="scroll-box"
      style="margin-top: 50px; width: 500px; height: 100px; overflow-y: scroll"
    >
      회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원
      약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관
      회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원
      약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관
      회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원
      약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관
      회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원
      약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관
      회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원 약관 회원
      약관 회원 약관 회원 약관 회원 약관
    </div>
    <p class="scroll-check" style="margin-top: 20px; color: red">
      약관을 읽어주셈
    </p>

    <!-- 스크롤 -->
    <div style="height: 1000px"></div>

    <!-- top버튼 -->
    <button class="btn-top" style="margin-left: 95%">top</button>

    <!-- =================================HTML============================================= -->

    <script>
      $('#login-btn').on('click', function () {
        $('.black-bg').addClass('show-modal');
      });

      $('#close').on('click', function () {
        $('.black-bg').removeClass('show-modal');
      });

      $('.navbar-toggler').on('click', function () {
        $('.list-group').toggleClass('show');
      });

      $('form').on('submit', function (e) {
        var emailInput = $('#email').val();
        var pwInput = $('#password').val();
        let emailRegex = new RegExp(
          '^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        );
        let pwRegex = new RegExp('[A-Z]');
        if (emailInput == '') {
          alert('이메일 입력하셈');
          e.preventDefault();
        } else if (!emailRegex.test(emailInput)) {
          alert('이메일 형식으로 쓰셈');
          e.preventDefault();
        } else if (pwInput == '') {
          alert('비번 입력하셈');
          e.preventDefault();
        } else if (pwInput.length <= 6) {
          alert('비번은 7자 이상이다');
          e.preventDefault();
        } else if (!pwRegex.test(pwInput)) {
          alert('비번은 알파벳 대문자 포함해야 함.');
          e.preventDefault();
        }
      });

      $('#password').on('input', function () {
        if ($('#password').val().length >= 7) {
          $('#pwLength').html('7자 이상 만족!!').css('color', 'green');
        }
      });

      var count = 0;
      $('.badge').on('click', function () {
        count++;
        if (count % 2 == 1) {
          $('#darkMode').html('Light');
          $('#body').addClass('dark');
          $('#mainComponent').css('background', 'Midnightblue');
        } else {
          $('#darkMode').html('Dark');
          $('#body').removeClass('dark');
          $('#mainComponent').css('background', 'lightgrey');
        }
      });

      var sec = 5;
      setInterval(function () {
        if (sec == -1) {
          $('.alert').hide();
        }
        $('.alert').html(sec + '초 이내 구매시 사은품 증정!');
        sec--;
      }, 1000);

      let page = 1;

      $('.slide-1').on('click', function () {
        $('.slide-container').css('transform', 'translateX(0vw)');
        page = 1;
      });
      $('.slide-2').on('click', function () {
        $('.slide-container').css('transform', 'translateX(-100vw)');
        page = 2;
      });
      $('.slide-3').on('click', function () {
        $('.slide-container').css('transform', 'translateX(-200vw)');
        page = 3;
      });

      $('.prePic').on('click', function () {
        page--;
        if (page <= 0) {
          page = 1;
        }
        var idx = page - 1;
        $('.slide-container').css('transform', 'translateX(-' + idx + '00vw)');
      });

      $('.nextPic').on('click', function () {
        page++;
        if (page >= 4) {
          page = 3;
        }
        var idx = page - 1;
        $('.slide-container').css('transform', 'translateX(-' + idx + '00vw)');
      });

      $(window).scroll(function () {
        if ($(this).scrollTop() >= 100) {
          $('.navbar-brand').css('font-size', '20px');
        }
        if ($(this).scrollTop() <= 100) {
          $('.navbar-brand').css('font-size', '30px');
        }
      });

      $('.btn-top').click(function () {
        $(window).scrollTop(0);
      });

      var scrollBoxHeight = $('.scroll-box').height();

      $('.scroll-box').scroll(function () {
        var scrollAmount = $(this).scrollTop();
        var scrollHeigth = $(this).prop('scrollHeight');
        if (Math.abs(scrollAmount + scrollBoxHeight - scrollHeigth) < 2) {
          $('.scroll-check').html('다 읽었군!').css('color', 'green');
        }
      });

      // e.target;             //유저가 실제로 누른거
      // e.currentTarget;      //이벤트리스너 달린 곳(this)
      // e.preventDefault();   //클릭 안한거처럼 동작
      // e.stopPropagation();  //이벤트 버블링 막아줌

      $('.black-bg').on('click', function (e) {
        e.stopPropagation();
        if (e.target == this) {
          $('.black-bg').removeClass('show-modal');
        }
        console.log(e.target);
        console.log(this);
      });

      var 시작좌표 = 0;
      var 눌렀니 = false;

      for (var i = 0; i < 3; i++) {
        slideAction(i);
        slideActionTouch(i);
      }

      function slideAction(index) {
        $('.slide-box')
          .eq(index)
          .on('mousedown', function (e) {
            시작좌표 = e.clientX;
            눌렀니 = true;
            console.log(눌렀니);
          });

        $('.slide-box')
          .eq(index)
          .on('mousemove', function (e) {
            if (눌렀니 == true) {
              $('.slide-container').css(
                'transform',
                `translateX(${e.clientX - 시작좌표}px)`
              );
              console.log(e.clientX - 시작좌표);
            }
          });

        $('.slide-box')
          .eq(index)
          .on('mouseup', function (e) {
            눌렀니 = false;

            console.log(e.clientX - 시작좌표);
            if (e.clientX - 시작좌표 < -100 && index < 2) {
              눌렀니 = false;

              $('.slide-container').css(
                'transform',
                `translateX(-${index + 1}00vw)`
              );
              page = index + 2;
            } else if (e.clientX - 시작좌표 > 100 && index > 0) {
              눌렀니 = false;

              $('.slide-container').css(
                'transform',
                `translateX(-${index - 1}00vw)`
              );
              page = index;
            } else if (
              e.clientX - 시작좌표 >= -100 &&
              e.clientX - 시작좌표 <= 100
            ) {
              눌렀니 = false;

              $('.slide-container').css(
                'transform',
                `translateX(-${index}00vw)`
              );
              page = index + 1;
            }
            console.log(눌렀니);
          });
      }

      function slideActionTouch(index) {
        $('.slide-box')
          .eq(index)
          .on('touchstart', function (e) {
            시작좌표 = e.touches[0].clientX;
            눌렀니 = true;
            console.log(눌렀니);
          });

        $('.slide-box')
          .eq(index)
          .on('touchmove', function (e) {
            if (눌렀니 == true) {
              $('.slide-container').css(
                'transform',
                `translateX(${e.touches[0].clientX - 시작좌표}px)`
              );
              console.log(e.touches[0].clientX - 시작좌표);
            }
          });

        $('.slide-box')
          .eq(index)
          .on('touchend', function (e) {
            눌렀니 = false;

            console.log(e.changedTouches[0].clientX - 시작좌표);
            if (e.changedTouches[0].clientX - 시작좌표 < -100 && index < 2) {
              눌렀니 = false;

              $('.slide-container').css(
                'transform',
                `translateX(-${index + 1}00vw)`
              );
              page = index + 2;
            } else if (
              e.changedTouches[0].clientX - 시작좌표 > 100 &&
              index > 0
            ) {
              눌렀니 = false;

              $('.slide-container').css(
                'transform',
                `translateX(-${index - 1}00vw)`
              );
              page = index;
            } else if (
              e.changedTouches[0].clientX - 시작좌표 >= -100 &&
              e.changedTouches[0].clientX - 시작좌표 <= 100
            ) {
              눌렀니 = false;

              $('.slide-container').css(
                'transform',
                `translateX(-${index}00vw)`
              );
              page = index + 1;
            }
            console.log(눌렀니);
          });
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
